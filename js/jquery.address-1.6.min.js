!function(t){t.address=function(){var e,r=function(e){return e=t.extend(t.Event(e),function(){for(var e={},r=t.address.parameterNames(),n=0,a=r.length;a>n;n++)e[r[n]]=t.address.parameter(r[n]);return{value:t.address.value(),path:t.address.path(),pathNames:t.address.pathNames(),parameterNames:r,parameters:e,queryString:t.address.queryString()}}.call(t.address)),t(t.address).trigger(e),e},n=function(t){return Array.prototype.slice.call(t)},a=function(){return t().bind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address},i=function(){return t().unbind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address},s=function(){return F.pushState&&T.state!==e},o=function(){return("/"+C.pathname.replace(new RegExp(T.state),"")+C.search+(c()?"#"+c():"")).replace(_,"/")},c=function(){var t=C.href.indexOf("#");return-1!=t?C.href.substr(t+1):""},u=function(){return s()?o():c()},d=function(){try{return top.document!==e&&top.document.title!==e&&top.jQuery!==e&&top.jQuery.address!==e&&top.jQuery.address.frames()!==!1?top:window}catch(t){return window}},l=function(){return"javascript"},p=function(t){return t=t.toString(),(T.strict&&"/"!=t.substr(0,1)?"/":"")+t},h=function(t,e){return parseInt(t.css(e),10)},f=function(){if(!K){var t=u();decodeURI(V)!=decodeURI(t)&&($&&7>q?C.reload():($&&!B&&T.history&&W(v,50),V=t,g(R)))}},g=function(t){return W(m,10),r(S).isDefaultPrevented()||r(t?I:U).isDefaultPrevented()},m=function(){if("null"!==T.tracker&&T.tracker!==x){var r=t.isFunction(T.tracker)?T.tracker:O[T.tracker],n=(C.pathname+C.search+(t.address&&!s()?t.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");t.isFunction(r)?r(n):t.isFunction(O.urchinTracker)?O.urchinTracker(n):O.pageTracker!==e&&t.isFunction(O.pageTracker._trackPageview)?O.pageTracker._trackPageview(n):O._gaq!==e&&t.isFunction(O._gaq.push)&&O._gaq.push(["_trackPageview",decodeURI(n)])}},v=function(){var t=l()+":"+R+";document.open();document.writeln('<html><head><title>"+L.title.replace(/\'/g,"\\'")+"</title><script>var "+k+' = "'+encodeURIComponent(u()).replace(/\'/g,"\\'")+(L.domain!=C.hostname?'";document.domain="'+L.domain:"")+"\";</script></head></html>');document.close();";7>q?z.src=t:z.contentWindow.location.replace(t)},y=function(){if(P&&-1!=Q){var t,e,r=P.substr(Q+1).split("&");for(t=0;t<r.length;t++)e=r[t].split("="),/^(autoUpdate|history|strict|wrap)$/.test(e[0])&&(T[e[0]]=isNaN(e[1])?/^(true|yes)$/i.test(e[1]):0!==parseInt(e[1],10)),/^(state|tracker)$/.test(e[0])&&(T[e[0]]=e[1]);P=x}V=u()},w=function(){if(!G){if(G=j,y(),t('a[rel*="address:"]').address(),T.wrap){var n=t("body");t("body > *").wrapAll('<div style="padding:'+(h(n,"marginTop")+h(n,"paddingTop"))+"px "+(h(n,"marginRight")+h(n,"paddingRight"))+"px "+(h(n,"marginBottom")+h(n,"paddingBottom"))+"px "+(h(n,"marginLeft")+h(n,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+k+'" style="height:100%;overflow:auto;position:relative;'+(N&&!window.statusbar.visible?"resize:both;":"")+'" />'),t("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"}),N&&t('<style type="text/css" />').appendTo("head").text("#"+k+"::-webkit-resizer { background-color: #fff; }")}$&&!B&&(n=L.getElementsByTagName("frameset")[0],z=L.createElement((n?"":"i")+"frame"),z.src=l()+":"+R,n?(n.insertAdjacentElement("beforeEnd",z),n[n.cols?"cols":"rows"]+=",0",z.noResize=j,z.frameBorder=z.frameSpacing=0):(z.style.display="none",z.style.width=z.style.height=0,z.tabIndex=-1,L.body.insertAdjacentElement("afterBegin",z)),W(function(){t(z).bind("load",function(){var t=z.contentWindow;V=t[k]!==e?t[k]:"",V!=u()&&(g(R),C.hash=V)}),z.contentWindow[k]===e&&v()},50)),W(function(){r("init"),g(R)},1),s()||($&&q>7||!$&&B?O.addEventListener?O.addEventListener(E,f,R):O.attachEvent&&O.attachEvent("on"+E,f):M(f,50)),"state"in window.history&&t(window).trigger("popstate")}},b=function(t){return t=t.toLowerCase(),t=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],{browser:t[1]||"",version:t[2]||"0"}},x=null,k="jQueryAddress",E="hashchange",S="change",I="internalChange",U="externalChange",j=!0,R=!1,T={autoUpdate:j,history:j,strict:j,frames:j,wrap:R},A=function(){var t={},e=b(navigator.userAgent);return e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),t}(),q=parseFloat(A.version),N=A.webkit||A.safari,$=!t.support.opacity,O=d(),L=O.document,F=O.history,C=O.location,M=setInterval,W=setTimeout,_=/\/{2,9}/g;A=navigator.userAgent;var z,B="on"+E in O,P=t("script:last").attr("src"),Q=P?P.indexOf("?"):-1,D=L.title,K=R,G=R,H=j,J=R,V=u();if($){q=parseFloat(A.substr(A.indexOf("MSIE")+4)),L.documentMode&&L.documentMode!=q&&(q=8!=L.documentMode?7:8);var X=L.onpropertychange;L.onpropertychange=function(){X&&X.call(L),L.title!=D&&-1!=L.title.indexOf("#"+u())&&(L.title=D)}}if(F.navigationMode&&(F.navigationMode="compatible"),"complete"==document.readyState)var Y=setInterval(function(){t.address&&(w(),clearInterval(Y))},50);else y(),t(w);return t(window).bind("popstate",function(){decodeURI(V)!=decodeURI(u())&&(V=u(),g(R))}).bind("unload",function(){O.removeEventListener?O.removeEventListener(E,f,R):O.detachEvent&&O.detachEvent("on"+E,f)}),{bind:function(){return a.apply(this,n(arguments))},unbind:function(){return i.apply(this,n(arguments))},init:function(){return a.apply(this,["init"].concat(n(arguments)))},change:function(){return a.apply(this,[S].concat(n(arguments)))},internalChange:function(){return a.apply(this,[I].concat(n(arguments)))},externalChange:function(){return a.apply(this,[U].concat(n(arguments)))},baseURL:function(){var t=C.href;return-1!=t.indexOf("#")&&(t=t.substr(0,t.indexOf("#"))),/\/$/.test(t)&&(t=t.substr(0,t.length-1)),t},autoUpdate:function(t){return t!==e?(T.autoUpdate=t,this):T.autoUpdate},history:function(t){return t!==e?(T.history=t,this):T.history},state:function(t){if(t!==e){T.state=t;var r=o();return T.state!==e&&(F.pushState?"/#/"==r.substr(0,3)&&C.replace(T.state.replace(/^\/$/,"")+r.substr(2)):"/"!=r&&r.replace(/^\/#/,"")!=c()&&W(function(){C.replace(T.state.replace(/^\/$/,"")+"/#"+r)},1)),this}return T.state},frames:function(t){return t!==e?(T.frames=t,O=d(),this):T.frames},strict:function(t){return t!==e?(T.strict=t,this):T.strict},tracker:function(t){return t!==e?(T.tracker=t,this):T.tracker},wrap:function(t){return t!==e?(T.wrap=t,this):T.wrap},update:function(){return J=j,this.value(V),J=R,this},title:function(t){return t!==e?(W(function(){D=L.title=t,H&&z&&z.contentWindow&&z.contentWindow.document&&(z.contentWindow.document.title=t,H=R)},50),this):L.title},value:function(t){if(t!==e){if(t=p(t),"/"==t&&(t=""),V==t&&!J)return;if(V=t,T.autoUpdate||J){if(g(j))return this;s()?F[T.history?"pushState":"replaceState"]({},"",T.state.replace(/\/$/,"")+(""===V?"/":V)):(K=j,N?T.history?C.hash="#"+V:C.replace("#"+V):V!=u()&&(T.history?C.hash="#"+V:C.replace("#"+V)),$&&!B&&T.history&&W(v,50),N?W(function(){K=R},1):K=R)}return this}return p(V)},path:function(t){if(t!==e){var r=this.queryString(),n=this.hash();return this.value(t+(r?"?"+r:"")+(n?"#"+n:"")),this}return p(V).split("#")[0].split("?")[0]},pathNames:function(){var t=this.path(),e=t.replace(_,"/").split("/");return("/"==t.substr(0,1)||0===t.length)&&e.splice(0,1),"/"==t.substr(t.length-1,1)&&e.splice(e.length-1,1),e},queryString:function(t){if(t!==e){var r=this.hash();return this.value(this.path()+(t?"?"+t:"")+(r?"#"+r:"")),this}return t=V.split("?"),t.slice(1,t.length).join("?").split("#")[0]},parameter:function(r,n,a){var i,s;if(n!==e){var o=this.parameterNames();for(s=[],n=n===e||n===x?"":n.toString(),i=0;i<o.length;i++){var c=o[i],u=this.parameter(c);"string"==typeof u&&(u=[u]),c==r&&(u=n===x||""===n?[]:a?u.concat([n]):[n]);for(var d=0;d<u.length;d++)s.push(c+"="+u[d])}return-1==t.inArray(r,o)&&n!==x&&""!==n&&s.push(r+"="+n),this.queryString(s.join("&")),this}if(n=this.queryString()){for(a=[],s=n.split("&"),i=0;i<s.length;i++)n=s[i].split("="),n[0]==r&&a.push(n.slice(1).join("="));if(0!==a.length)return 1!=a.length?a:a[0]}},parameterNames:function(){var e=this.queryString(),r=[];if(e&&-1!=e.indexOf("=")){e=e.split("&");for(var n=0;n<e.length;n++){var a=e[n].split("=")[0];-1==t.inArray(a,r)&&r.push(a)}}return r},hash:function(t){return t!==e?(this.value(V.split("#")[0]+(t?"#"+t:"")),this):(t=V.split("#"),t.slice(1,t.length).join("#"))}}}(),t.fn.address=function(e){return t(this).each(function(){t(this).data("address")||t(this).on("click",function(r){if(r.shiftKey||r.ctrlKey||r.metaKey||2==r.which)return!0;var n=r.currentTarget;t(n).is("a")&&(r.preventDefault(),r=e?e.call(n):/address:/.test(t(n).attr("rel"))?t(n).attr("rel").split("address:")[1].split(" ")[0]:void 0===t.address.state()||/^\/?$/.test(t.address.state())?t(n).attr("href").replace(/^(#\!?|\.)/,""):t(n).attr("href").replace(new RegExp("^(.*"+t.address.state()+"|\\.)"),""),t.address.value(r))}).on("submit",function(r){var n=r.currentTarget;t(n).is("form")&&(r.preventDefault(),r=t(n).attr("action"),n=e?e.call(n):(-1!=r.indexOf("?")?r.replace(/&$/,""):r+"?")+t(n).serialize(),t.address.value(n))}).data("address",!0)}),this}}(jQuery);